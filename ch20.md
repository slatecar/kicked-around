Chapter 20
==========

<br />

Erik jolted awake the next morning to his alarm. He was exhausted from
the late night before. After his significant discovery, he kept thinking
about how Marvin hacked Lara’s website. Erik was extremely tired by the
time he concluded how Lara’s laptop was compromised, so he wasn’t able
to research much more. Erik checked some of the server logs that he
copied down and noticed that they were blank too. After that dead end,
Erik was too drained to keep looking. He was too tired to do anything
except collapse in his bed and fall asleep.

When he woke up, he was still wearing the same clothes from the night
before. He had a raging erection that was bulging from his shorts. Erik
undressed, wrapped himself in a towel, and walked to the bathroom with
his shower caddie. Erik masturbated in the shower, thinking of one of
the BDSM porn videos that he watched recently.

Erik imagined slapping his cock up against the mouth of the girl in the
video as he smacked it against his hand in the shower. He forcefully
rammed his cock into her mouth, and she choked on it. Erik called her a
bitch and told her that she looked like a dirty slut. "Beg me for my
cum, whore," he said in his fantasy. "Beg me. You fucking slut." Erik
smacked her across the mouth and then grabbed her head, thrusting
himself into her mouth, so that his cock reached the back of her throat.
She choked some more before she pushed him out. Erik came all over her
face and mouth. He rubbed his cock all over her face, pushing the cum
into her mouth. The girl then pushed it out of her mouth, letting it run
down her lips and chin.

Erik opened his eyes and watched the cum roll down the back wall of the
shower. He threw water on the back wall to wash it down. Then, he made
sure that the cum washed down the drain. Erik finished showering and
went to class. The swelling in his nose was very minor now, and he was
starting to look normal again.

Erik entered the classroom and took a seat. Jessica entered and looked
angry. She didn’t say anything, just sat down in front of him and stared
straight ahead. Erik stared at her, wondering what the problem was.
Jessica didn’t turn around, just watched the wall, straight ahead.

Eventually, class started, and Professor Hand gave Erik his midterm.
Erik got a C+. "Fuck," Erik thought. "I thought I did better than that."
Erik noticed that the class had thinned out. Only about ⅔ of the
students were there. Erik also saw that Bob was gone.

After handing back the midterm to Erik, Professor Hand made reference
that some of the students did so poorly on the exam that there was no
chance that they would pass the class. Those students had taken it upon
themselves to drop the class. "If Jessica dumped Dave and Bob failed the
class, are these fuckers really gone?" Erik thought. "Is it over?"

After class, Erik and Jessica got on the bus. She looked very upset.
Erik wanted to say something to her, but he just didn’t know if it was
safe... yet. In addition, he was still preoccupied with the work he had
ahead of him. When the bus arrived back at the dorms, Erik rushed up to
his room to continue his research. Everything was just as Erik had left
it when he passed out the night prior. Erik started back at tracking
down how "Marvin" hacked Lara’s website.

Erik decided that he should investigate the Botnet. He connected to the
ROT network and then connected to the IRC server that he found in the
decompiled executable from Lara's computer. Erik joined the IRC channel
where he saw hundreds of other users with names that began with
"martian." Starting with "martian01" and continuing to "martian99".
Then, the numbers restarted with the prefix "martia100" and continued
on. The highest number was "martian593". There were two operators of the
channel: "marvin01" and "marvin02". Upon joining the channel, he was
kicked and banned. This prevented Erik from rejoining the channel.

Erik reconnected to the ROT network so that it would change his IP
address. Then, he rejoined the IRC network. This time, he changed his
IRC handle to "martia601" and joined the IRC channel. Upon joining the
channel, he received a direct message from "marvin02" that stated:
"initiate\_auth." Erik stared at the message, trying to think what he
should enter. He entered the password to the IRC channel and sent it.
Immediately, he was kicked and banned again from the IRC channel.

Erik realized that if he wanted to continue investigating the IRC
channel, he would need to thoroughly analyze the decompiled executable
that was running on Lara's laptop to reverse engineer the communication
protocols that the Botnet was utilizing. Erik decided that was going to
take too long, so he decided to look at the API account information for
the text sharing service that was used to post the URL of the file
upload. Erik reviewed the API documentation of the text sharing service
to see what he could do with the API account information.

Erik found that there were API functions to return all the submissions
that were made to the text-sharing site using the API account. Erik made
the request and found hundreds of links returned that spanned three
years. Erik opened the first one in a browser. The link contained a URL
to the same file sharing web service that had Lara's files posted. Erik
clicked the link, and the file sharing web service responded with the
message "Link expired." Erik navigated to the file-sharing website's FAQ
(Frequently Asked Questions). He read that unauthenticated submissions
were only available for 30 days. After that, they were removed.

Erik tried the most recent URL returned from the text-sharing site, and
it contained another link to the file sharing service. Erik downloaded
the file attached to the link and opened it. The file was comprised of
the contents of Lara's hard drive. "Well, that sucks," Erik said. "At
least it's only going to be available for 30 days, and you need to have
the direct link to access it."

Erik continued to research the other API functions from the text-sharing
site. There was another API function that could be used to retrieve the
API account owner's information and settings. Erik made the request, and
it returned back an email address. Erik took the email address and did a
web search for it. Nothing came up. Then, Erik opened a "Deep Web"
search site on the ROT network and searched for the email. There was a
result for a site that was only available when using the ROT network.

Erik opened the link, which led to a site called "Illudium." The direct
URL was a "Contact" page that contained the statement: "For a price,
I’ll do pretty much anything." Erik navigated around Illudium for
awhile. There were various links to other websites on the ROT network
where there was free porn downloadable as torrents, revenge porn sites,
and links to 0-day exploits. Erik looked at the original "Contact" page
link that led him to "Illudium." He re-read the statement: "For a price,
I’ll do pretty much anything."

"Maybe someone paid this guy to go after Lara?" Erik thought. "That
doesn’t make any sense though. Unless she pissed someone off. Maybe, the
asshole customer that she rejected paid this Marvin to do something.
Maybe they’re the same person. What could she have said to piss somebody
off this much?"

Erik turned back to Lara’s website, trying to find just how Marvin was
able to get in initially. Erik checked the common vulnerability
databases online and found nothing recent for the version of the Content
Management System Lara was using. "There could be some type of zero-day
exploit in the wild that no one from the CMS project knows about," Erik
thought. " That would be why there’s no patch for it. But, people would
be using that to attack bigger sites. This CMS is used for much bigger
shit than some college chick’s porn site."

Erik decided to run commands to check differences in the files, which
compared two files line-by-line. He checked the files from the CMS
project site with the code files he had installed on Lara’s website.
There were no differences found. Then, Erik started looking through the
plugins he had installed. Each one of them had a vibrant community
around them with donation pages, bug reports, and source control
repositories to help contribute. All of them, except one, the plugin
that Erik used to upload captured video from the cam sessions
automatically.

"That’s odd," Erik thought. "I could have sworn this was the most
popular plugin for this type of automatic video upload. I had to pay
\$20 for it too." Erik searched around and found that it was the
"recommended plugin" to use for this purpose. The plugin integrated
seamlessly to the most popular video chat client. There were several
positive reviews on the site, but on the plugin page, there were no
updates for the past year.

Erik checked the time and realized he needed to leave for Math class. He
rushed out and caught the bus just in time. When he arrived at the Math
class, Jessica was sitting there already, still looking very upset. Erik
walked by her and sat down. She was texting on her phone and didn’t even
acknowledge that he walked in the door.

"She looks so sad," Erik thought. "I wonder what happened with her and
Dave..." Erik’s mind drifted back to Marvin and Lara’s website. "Maybe
it’s the plugin. But then what? If it’s a vulnerability in the plugin,
then I can send it to the plugin developer, and hopefully, he can fix it
for everyone else. Otherwise, I need to turn off automatic updates for
that one so that it doesn’t override the patch with the bad code. I’m
getting too far ahead. I don’t even know if that’s the problem."

When the Math instructor arrived, she handed Erik his test. Erik
received an A-. Several students were also missing from this class. The
instructor in the Math class gave the same explanation as Professor Hand
that several students scored far too low to have a reasonable chance of
passing the class. Then, the instructor went into the next lesson.

Erik wasn’t able to focus on the class, his mind kept drifting. "What if
it’s something different altogether? What if there’s some 0-day in the
web server? Maybe in the kernel? No, that just can’t be. This would be a
big deal. There would be security researchers all over it. But wait,
what if they knew about it and they’re using it to exploit sites on
their own? What if the researchers are hacking websites with the
vulnerabilities that they find and only disclosing after they’ve built
up their own botnets in a bid to silently pwn every server on the
Internet to use for their own evil, chaotic means? Oh my god! I’ve
stumbled upon the greatest Internet security conspiracy of all time!"

Erik laughed at himself. As far as panic attack-prone, anxiety plagued
nerds go, Erik knew he was one of the most paranoid people that ever
owned a computer. But, as far as conspiracy theories go, he was pretty
sure they were mostly bullshit. Still, he always gave himself a good
laugh when his anxiety became too much to handle and generated wild
theories that could be intertwined with the other "unexplainable
mysteries of the universe." It was a defense mechanism, a way of keeping
a handle on himself, through ridicule and laughter.

After class, Erik followed Jessica, along with the other students, out
of the classroom and onto the bus. She still looked so unhappy that it
made Erik want to cry. When they got off the bus, she exited toward the
girl's side, and Erik went to the cafeteria. He picked up a tray and
took it back to his room to continue his research.

Erik sat down at his computer and began to analyze the plugin code as he
ate his dinner. The code was encrypted with a popular tool that requires
a loader on the web server to run the encrypted code. This was typical
for applications that were created using a scripting language, so that
the creator can protect the code from piracy, reverse engineering or
some other undesired use.

For Erik, the plugin was not readable. There was not much he could do to
figure out how or what it was doing. So, Erik started to research a way
of decrypting the plugin back into its original scripting language. Erik
found a few programs that would do this, but none that were free. "At
this point," he started to gather a thought, "Lara can pay for anything
I have to buy to fix this."

Erik paid for one of the tools and attempted to decrypt the plugin code.
The tool reported that the decryption process was successful, but when
Erik looked at the results it still looked completely unreadable as if
it was still encrypted. The file looked different, but it still appeared
to be indecipherable nonsense. "Well that didn’t work," Erik thought.
"Fuck..." Erik opened another screen, paid for the next tool, and
followed the same process. Again, the tool said the process was
successful, but the file still looked like it was encrypted. "FUCK!," he
said. "Does nothing fucking work anymore?!?"

Erik looked downward and put his head in his hands. "Alright," he
thought. "If I can’t see the code, then can I trust it? But I paid for
it... And it’s the top reviewed plugin... I can’t be the only one that’s
having problems like this. No, it can’t be the plugin. It’s got to be
something else. Does it? If I can’t rule it out, what the fuck do I do?
She needs this, and it’s simple to use. If I find something else for her
and she has to do all this shit manually, she’s going to be pissed.
Especially if I can’t say that I know this is the problem. Maybe I just
trust it? Same as the operating system, same as the web server..."

Erik looked up at the screen. He shook his head as he saw the numbers
and letters that looked like encrypted gibberish. Then, he finally
noticed that the first few characters of the file were the scripting
language’s start tag, followed by "eval ( base64\_decode (" and then the
encoded information. "What the fuck?" Erik said to himself. Erik
scrolled down to the bottom and saw the scripting language’s closing tag
at the end of the file.

Erik switched the window back to the results of the first decryption
tool. It showed the same thing. "Son of a bitch," Erik thought. "It did
work! But, what the hell is base64 decode?" Erik did some more research
and found that the code itself was base64 encoded, which meant that it
was translated to look different using an open standard found in
technology. After some more research, Erik concluded that this was a
typical way for programmers to obfuscate code, which meant that the
programmer was attempting to make it difficult for others to read the
code.

Erik found a simple tool to decode the base64. The result was code in
the original programming language. Erik could now read the code and find
out what it was doing. The plugin appeared to do exactly what it was
intended. There was nothing harmful here that he could see. The plugin
wasn’t communicating out anywhere, it wasn’t attempting to download
anything from anywhere, and the only account that it created was the one
API account that Erik knew about when he first installed the plugin.

"Maybe that account uses a standard password, and the plugin creator
knows it, and he’s using it to get into the website?" Erik thought to
himself. "It’s a stretch, but is it possible?" Erik found where the
account was created and it used a Psuedo-random number generator to
generate a random number, then it appended a time stamp of the current
date and time to the millisecond, and then used a one-way hash algorithm
to hash the result. The hash was used as the account password when it
generated the new account using the CMS API to create a new user.
Afterward, it called a function called "exit\_."

Erik was very familiar with hashes. Only weeks earlier, he used a
rainbow table to crack a hash that held the password to his old High
School’s grade system. A one-way hash algorithm applies a mathematical
function to produce an output that couldn’t be "reversed." You could
apply the hash algorithm on a value, but you couldn’t un-hash the hashed
value.

"Seems random enough," Erik thought. "The guy wrote this wouldn’t know
the timestamp when this thing was installed or the random number that
was generated at the time the account was created. Hashing it at the end
would generate a value that looks like a completely random password."
Erik kept looking and stared at the final "exit\_" function. The
standard "exit" was part of the interpreter, which would exit the
script. However, this function was called "exit\_," which is not the
same. At first glance, Erik missed it, but looking deeper he realized
that he needs to figure out what this function did.

The "exit\_" function wasn’t in the same file. It was a function that
was included in a file called "Validate." The "exit\_" function created
a file called "certificate" in the same folder as the plugin. The
contents of the file were also base64 encoded. From the code, Erik saw
it stored the user account password in the file. Erik opened the file
and decoded the contents. Sure enough, it was the password for the API
account. "Why the fuck would someone do that?" Erik thought. Erik moved
the "certificate" file to a different folder and then refreshed his
browser. Erik’s VM instance of Lara’s site now asked for a certificate
key.

Erik remembered that when he setup the plugin, it required registration.
Erik had to put in Lara’s email and the URL of the site to get the key.
Erik re-entered the certificate key, and the site let him back into the
plugin configuration page. Erik looked back and saw that a new
"certificate" file was created. Except, this one was blank.

Erik looked into the code and saw that when the certificate key is
entered, that’s when the API account is created. There was a comment in
the code that said "Save certificate key to the certificate file." Right
after the comment, the new API user’s password is stored in the
"certificate" file, base64 encoded.

"WOW," Erik thought. "It’s a BUG!!! He meant to store the key, but he
stores the account password instead." Erik continued to research the
code. He found that every reference to this key file only looks for the
existence of the "certificate," but doesn’t read the contents of the
file. "Holy shit!" Erik thought. "Someone found out about this and used
it to hack into Lara’s site! That has got to be it!." Erik’s heart was
racing; his mind was firing off praise and joy now that the puzzle was
solved. Erik felt very confident that he found the way that the attacker
got into Lara’s site. Now, all Erik needed to do was empty the contents
of that file on installation and reset the API account password just to
be safe.

Erik felt like a god. He found the hole, and he found a way to patch it
without affecting the site’s functionality. He was flooded with new
nervous energy. Erik stretched forward and picked up a top that was on
his desk. Then, he spun it in on his desk as his mind reset and started
down a new track. He held his clenched fist to his lips, shaking
nervously and deep in thought. "What about everyone else using this
thing?" Erik thought. "They’re all vulnerable to this." Erik thought
more about it. The devious side of his mind thought about how it could
be used to his own gains. These evil thoughts always gave him a laugh,
but he never acted on them. After about 5 minutes of spinning the top
while thinking how he could build a botnet of zombie servers, Erik
decided that the right thing to do was to tell the developer about it.
Erik’s mind began racing about the pros and cons about notifying the
developer.

"What if he thinks I’ve been using the bug to hack his customers?" Erik
thought. "What if he decides to contact the police... or the FBI... What
if they come for me? What the fuck do I do?"

Erik couldn’t get his mind off of how the developer would handle this
information. So, Erik decided to create a brand new email account and
disclose the bug to the developer. In the email, Erik explained that he
feels everyone else needs to know about it so, in 4 weeks, he will be
publishing the findings to a full disclosure security mailing list. At
that point, the entire security community will be aware of the bug, and
it will most likely be added to the publicly searchable vulnerability
databases that are on the Internet. Erik sent the email. This was Erik’s
attempt at disclosing the bug responsibly to the original developer to
give them a chance to fix it without attaching his name to the finding.

It was now 5 AM Wednesday morning. Erik had worked on this all night
long, into the early morning of the next day without even realizing it.
Daylight was starting to peek through the window and after a night of
highs and lows, Erik felt triumphant. He was still smiling, thinking
about how incredible his find was, as he restarted his laptop into it’s
regular environment navigated to a porn tube site and took off his
pants.
